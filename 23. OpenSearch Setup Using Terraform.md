# OpenSearch Setup Using Terraform

The Nautilus DevOps team needs to set up an Amazon OpenSearch Service domain to store and search their application logs. The domain should have the following specification:

- The domain name should be `datacenter-es`.

- Use `Terraform` to create the `OpenSearch` domain. 

Before submitting the task, ensure that `terraform plan` returns `No changes. Your infrastructure matches the configuration`.

>[!Caution]
> The OpenSearch domain creation process may take several minutes. Please wait until the domain is fully created before submitting.

>[!Tip]
> It may take **10 minutues**

The Terraform working directory is `/home/bob/terraform`. Create the `main.tf` file (do not create a different `.tf` file) to accomplish this task.

**`/home/bob/terraform/main.tf`** 

```HCL
resource "aws_opensearch_domain" "datacenter_es" {
  domain_name    = "datacenter-es"
  engine_version = "OpenSearch_2.11"

  cluster_config {
    instance_type  = "t3.small.search"
    instance_count = 1
  }

  ebs_options {
    ebs_enabled = true
    volume_type = "gp3"
    volume_size = 10
  }

  access_policies = <<EOF
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": { "AWS": "*" },
      "Action": "es:*",
      "Resource": "arn:aws:es:us-east-1:*:domain/datacenter-es/*"
    }
  ]
}
EOF
}
```

## How to apply

```bash
terraform init
terraform apply -auto-approve
```

```sh
terraform plan
```

**Expected output:**

```
No changes. Your infrastructure matches the configuration.

Terraform has compared your real infrastructure against your
configuration and found no differences, so no changes are
needed.
```
