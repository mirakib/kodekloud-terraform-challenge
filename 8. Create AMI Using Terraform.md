# Create AMI Using Terraform

- For this task, create an AMI from an existing EC2 instance named `xfusion-ec2` using Terraform.
- Name of the AMI should be `xfusion-ec2-ami`, make sure AMI is in `available` state.
- The Terraform working directory is `/home/bob/terraform`. Update the `main.tf` file (do not create a separate .tf file) to create the AMI.

**`main.tf`**

```HCL
# Provision EC2 instance
resource "aws_instance" "ec2" {
  ami           = "ami-0c101f26f147fa7fd"
  instance_type = "t2.micro"
  vpc_security_group_ids = [
    "sg-183e42a39d28feccc"
  ]

  tags = {
    Name = "xfusion-ec2"
  }
}
```

**Updated** **`main.tf`**

```HCL
# Provision EC2 instance
resource "aws_instance" "ec2" {
  ami           = "ami-0c101f26f147fa7fd"
  instance_type = "t2.micro"

  vpc_security_group_ids = [
    "sg-183e42a39d28feccc"
  ]

  tags = {
    Name = "xfusion-ec2"
  }
}

# Create AMI from existing EC2 instance
resource "aws_ami_from_instance" "xfusion_ec2_ami" {
  name               = "xfusion-ec2-ami"
  source_instance_id = aws_instance.ec2.id

  tags = {
    Name = "xfusion-ec2-ami"
  }
}
```

## How to apply

```bash
terraform init
terraform plan
terraform apply
```

## Verify AMI creation

```bash
terraform show | grep xfusion-ec2-ami
```

You should see `xfusion-ec2-ami` in `available` state.
