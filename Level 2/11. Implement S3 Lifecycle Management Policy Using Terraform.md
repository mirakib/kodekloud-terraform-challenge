# Implement S3 Lifecycle Management Policy Using Terraform

The Nautilus DevOps team is implementing lifecycle policies to manage object storage efficiently in AWS. They want to create an S3 bucket with a specific lifecycle rule that transitions objects to infrequent access (IA) storage after 30 days and deletes them after 365 days.

1. Create an S3 bucket named `devops-lifecycle-17345`.

2. Enable the S3 Versioning on the bucket.

3. Add a lifecycle rule named `devops-lifecycle-rule` with:
   - Transition to `STANDARD_IA` storage class after `30` days.
   - Expiration of objects after `365` days.

4. Use the `main.tf` file (do not create a separate `.tf` file) to provision the S3 bucket.
5. Use the variable name `KKE_bucket_name` in the `outputs.tf` file to output the created bucket name.

>[!Note]
> **Before submitting the task, ensure that terraform plan returns `No changes. Your infrastructure matches the configuration`.**

**`/home/bob/terraform/main.tf`**

```hcl
resource "aws_s3_bucket" "devops_lifecycle_bucket" {
  bucket = "devops-lifecycle-17345"

  tags = {
    Name        = "devops-lifecycle-17345"
    Environment = "DevOps"
  }
}

resource "aws_s3_bucket_versioning" "versioning" {
  bucket = aws_s3_bucket.devops_lifecycle_bucket.id

  versioning_configuration {
    status = "Enabled"
  }
}

resource "aws_s3_bucket_lifecycle_configuration" "lifecycle" {
  bucket = aws_s3_bucket.devops_lifecycle_bucket.id

  rule {
    id     = "devops-lifecycle-rule"
    status = "Enabled"

    transition {
      days          = 30
      storage_class = "STANDARD_IA"
    }

    expiration {
      days = 365
    }

    filter {}
  }
}
```

**`/home/bob/terraform/outputs.tf`**

```hcl
output "KKE_bucket_name" {
  value = aws_s3_bucket.devops_lifecycle_bucket.bucket
}
```

## How to apply

```bash
terraform init
terraform apply -auto-approve
terraform plan
```
